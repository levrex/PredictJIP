import math

def kan_encoder_poly(row): # KAN based encoder for polyarthritis
    SJC_FOOT  = row['SJC_FOOT']
    SJC_HAND  = row['SJC_HAND']
    TJC_FOOT  = row['TJC_FOOT']
    TJC_HAND  = row['TJC_HAND']
    SJC44     = row['SJC44']
    TJC44     = row['TJC44']
    Small44   = row['Small44']
    Big44     = row['Big44']
    Age       = row['Age']
    RF        = row['RF']
    aCCP      = row['aCCP']
    Sex       = row['Sex']
    handFrac  = row['handFrac']
    bigFrac   = row['bigFrac']

    term1 = (
        -0.0473836988748146*SJC_FOOT
        - 0.0373404320600377*RF
        - 0.0607547381557813*aCCP
        - 0.0998939311183757*Sex
        - 2.46303083339918e-6*bigFrac
        - 0.0507307815138762*SJC_HAND
        - 0.0243730311692521*TJC_FOOT
        - 0.0695642091519497*TJC_HAND
        - 0.0566374855296735*SJC44
        - 0.0350791695468444*TJC44
        + 0.111530682751247*Small44
        + 0.0910147266699641*Big44
        - 0.00477230703979441*Age
        - 0.00912277880608428*(bigFrac + 0.638425493267219)**2
        - 0.00010686059981897*math.exp(0.455119848251343*handFrac)
    )

    term2 = 0.00923484115785999 * math.exp(
        0.120091878343534*SJC_FOOT
        - 0.0157015837507353*RF
        + 0.106832596730027*aCCP
        + 0.187442877506273*Sex
        + 0.00521609697938352*handFrac
        - 0.191135288005476*TJC_FOOT
        + 0.163156693422326*TJC_HAND
        - 0.00497032675437746*SJC44
        - 0.0602070320812943*TJC44
        - 0.000499225646968115*Small44
        + 0.159747847817014*Big44
        + 0.026305760741079*Age
        + 0.0298098534018222*math.exp(0.815759837627411*bigFrac)
        + 0.039617638420296*math.sin(0.192479997873306*SJC_HAND - 7.9398398399353)
    )

    term3 = (
        - 0.00014934228138983*math.sin(2.15823984146118*handFrac + 1.83023989200592)
        - 0.0180533414223042*math.sin(3.33063983917236*handFrac - 0.955759823322296)
        - 7.11527637776832e-5*math.sin(3.19928002357483*bigFrac - 7.39751958847046)
    )

    term4 = 0.286461561918259 * math.sin(
        -0.00695394949845646*SJC_FOOT
        - 0.00251801978398269*RF
        + 0.0326786658455718*aCCP
        + 0.0180563899314185*Sex
        - 0.0146388628158012*handFrac
        + 0.00694024923869859*bigFrac
        + 0.07461485854692*SJC_HAND
        + 0.0749533255113067*TJC_FOOT
        - 0.0650342990737628*TJC_HAND
        - 0.0572616233266571*SJC44
        + 0.00416578070178312*TJC44
        + 0.00324857472778949*Small44
        - 0.0209382231948354*Big44
        - 0.0462113325449074*Age
        + 4.21161363938684
    )

    return term1 + term2 + term3 + term4 + 0.0348441599703432


def kan_encoder_foot(row): # KAN based encoder for foot arthritis
    term1 = (
        0.00461812946998921*row['SJC_FOOT']
        + 0.000614217544413759*row['RF']
        + 0.0207018771226366*row['aCCP']
        + 0.0235707008355813*row['Sex']
        - 0.000515071926080165*row['handFrac']
        + 1.16783304891576e-5*row['bigFrac']
        + 0.039887221573958*row['SJC_HAND']
        - 0.0396306979950028*row['TJC_FOOT']
        + 0.00764606277592921*row['TJC_HAND']
        + 0.0100103116549517*row['SJC44']
        + 0.0127685944622615*row['TJC44']
        - 0.0314095201016078*row['Small44']
        - 0.0639068522830264*row['Big44']
        + 0.00653184206202455*row['Age']
    )

    term2 = (
        -0.00408938632582765*math.sin(1.66479980945587*row['handFrac'] + 2.34159994125366)
        - 0.000561643479744568*math.sin(1.77175986766815*row['handFrac'] + 4.81392002105713)
        - 0.0037351159199086*math.sin(1.57079982757568*row['bigFrac'] - 7.39807987213135)
        + 0.0004363906794251*math.sin(1.66951990127563*row['bigFrac'] + 8.43535995483398)
        - 0.000581017514482044*math.sin(6.03239965438843*row['TJC_FOOT'] + 6.20815992355347)
    )

    term3 = 0.621200978755951 * math.sin(
        -0.0209801335114208*row['SJC_FOOT']
        + 0.00886686569894667*row['RF']
        - 0.0484529944891645*row['aCCP']
        - 5.55626858858328e-5*row['bigFrac']
        + 0.0747780139605518*row['SJC_HAND']
        + 0.0216834845322259*row['TJC_FOOT']
        - 0.0622710881731557*row['TJC_HAND']
        - 0.0675681943392233*row['SJC44']
        + 0.0129579861462266*row['TJC44']
        + 0.0492622888041418*row['Small44']
        + 0.051384535671983*row['Big44']
        - 0.0104167585255824*row['Age']
        - 0.00556702918554741*(-0.823045323151462*row['handFrac'] - 1)**2
        + 8.15970663744272
        + 6.91419670642587e-5*math.exp(-3.0719997882843*row['Sex'])
    )

    term4 = 1.96504151821136 * math.sin(
        -0.00991078901119619*row['SJC_FOOT']
        + 0.0139212563498185*row['RF']
        - 0.027331301325035*row['aCCP']
        + 0.0561168486697592*row['Sex']
        + 0.0392789186045439*row['SJC_HAND']
        - 0.0802217822955154*row['TJC_FOOT']
        + 0.0164802133491499*row['TJC_HAND']
        + 0.014132895240485*row['SJC44']
        + 0.0113768381219699*row['TJC44']
        - 0.0360621168166609*row['Small44']
        - 0.0717358004532375*row['Big44']
        + 0.01073024688987*row['Age']
        + 0.0299097576230914*(-0.984345252794188*row['bigFrac'] - 1)**2
        + 0.038510343232991*math.sin(1.32359993457794*row['handFrac'] + 8.43648052215576)
        + 8.38339759395229
    )

    return term1 + term2 + term3 + term4 - 1.55430703696564